# RandPerson
This project contains the ReandPerson dataset described in our paper "[Surpassing Real-World Source Training Data: Random 3D Characters for Generalizable Person Re-Identification](https://arxiv.org/abs/2006.12774)".  

<p align="center"><img width=700 src="https://github.com/VideoObjectSearch/RandPerson/blob/master/img/unity.png"></p>
<p align="center">Fig. 1. Sample images from the proposed RandPerson dataset.</p>  

## Table of Contents

- [Dataset Description](#link-of-the-dataset)
- [Characters and Scenes](#characters-and-scenes)
- [Experimental Results](#experimental-results)
- [Contacts](#contacts)
- [Citation](#citation)

## Dataset Description

The RandPerson dataset is generated by [MakeHuman](http://www.makehumancommunity.org/) and [Unity3D](https://unity.com/). This is the first synthetic person re-identification dataset with a set-up similar to real video surveillance systems, i.e. with a camera network and multiple people moving at the same time. The dataset contains 1,756,759 synthesized person images of 8,000 identities. Images in this dataset generally contain different viewpoints, poses, illuminations, backgrounds, occlusions, and resolutions, as shown in Fig. 1. 

### Download Links
Due to the large amount of data, currently only the image subset used in the experiments of our paper is provided, including 128,160 images. They can be downloaded from the following links. The dataset is uploading.

* [Baidu Yun Drive](https://xx) (code: ueeg)
* [Google Drive](https://xx)

### File Structure
```shell
randperson_subset
├── 000000_s00_c00_f000264.jpg
├── 000000_s00_c00_f001032.jpg
├── 000000_s00_c01_f001632.jpg
```

The filenames are encoded as follows. Take "000000_s00_c00_f000264.jpg" as an example,
*  000000 is the id of the person
*  s00   is the id of the scene
*  c00   is the id of the camera
*  f000264   is the number of frames

## Characters and Scenes

We design a method to generate a large number of random UV texture maps and use them to create different 3D clothing models. Then, an automatic code is developed to randomly generate various different 3D characters with diverse clothes, races and attributes. Fig. 2 shows examples of our generated clothing and characters.

<p align="center"><img height=250 src="https://github.com/VideoObjectSearch/RandPerson/blob/master/img/makehuman.png"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img height=250 src="https://github.com/VideoObjectSearch/RandPerson/blob/master/img/scene.png"></p>
<p align="center">&nbsp;&nbsp;&nbsp; Fig. 2. Examples of generated clothes and characters. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Fig. 3. Customized Unity3D scenarios used in this work.</p>

Next, we simulate a number of different virtual environments (including 11 scenes, eight outdoor and three indoor, as shown in Fig. 3) using Unity3D, with customized camera networks similar to real surveillance systems. Finally, we import multiple 3D characters at the same time, with various movements and interactions along different paths through the camera networks. The simulation is illustrated in Fig. 4.

<p align="center"><img width=600 src="https://github.com/VideoObjectSearch/RandPerson/blob/master/img/scene_detail.png"></p>
<p align="center">Fig. 4. Example configuration of camera networks and character movements.</p>

## Experimental Results

By training person re-identification models on these synthesized person images, we demonstrate, for the first time, that models trained on virtual data can generalize
well to unseen target images, surpassing the models trained on various real-world datasets, including CUHK03, Market-1501, and partially DukeMTMC-reID and MSMT17. The experimental results are shown in the following tables.

<p align="center"><img height=300 src="https://github.com/VideoObjectSearch/RandPerson/blob/master/img/table2.png"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img height=300 src="https://github.com/VideoObjectSearch/RandPerson/blob/master/img/table3.png"></p>

<p align="center"><img height=300 src="https://github.com/VideoObjectSearch/RandPerson/blob/master/img/table4.png"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img height=300 src="https://github.com/VideoObjectSearch/RandPerson/blob/master/img/table5.png"></p>

## Contacts

Yanan Wang  
Inception Institute of Artificial Intelligence (IIAI)  
yanan.wang@inceptioniai.org

## Citation

@article{RandPerson,  
  author    = {Yanan Wang and Shengcai Liao and Ling Shao},                 
  title     = {Surpassing Real-World Source Training Data: Random {3D} Characters for Generalizable Person Re-Identification},    
  journal   = {arXiv:2006.12774},    
  year      = {2020}    
}

